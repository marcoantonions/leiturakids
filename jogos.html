<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <link rel="icon" type="image/png" href="img/ancora.png">
    <link rel="stylesheet" type="text/css" href="style_jogos.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogos - Leitura Kids</title>
</head>

<body>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        const SUPABASE_URL = 'https://dnphjoqmkvnjueiwjayu.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRucGhqb3Fta3ZuanVlaXdqYXl1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjE3ODEsImV4cCI6MjA3MzUzNzc4MX0.r8-M9EZg73sIrwESfd61hyGITsEwv_TJFZOBYeXk3d8';
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        window.supabaseClient = supabase;

        async function carregarPontuacaoGlobal() {
            const usuarioId = localStorage.getItem('usuarioId');
            if (!usuarioId) return;

            try {
                const { data, error } = await supabase
                    .from('progresso')
                    .select('pontos, jogos_concluidos, acertos')
                    .eq('user_id', usuarioId)
                    .maybeSingle();

                if (data) {
                    document.getElementById('total-score').textContent = data.pontos ?? 0;
                    document.getElementById('total-correct').textContent = data.acertos ?? 0;
                    document.getElementById('games-played').textContent = data.jogos_concluidos ?? 0;

                    const gameStats = {
                        totalScore: data.pontos ?? 0,
                        totalCorrect: data.acertos ?? 0,
                        gamesPlayed: data.jogos_concluidos ?? 0,
                    };
                    localStorage.setItem('gameStats', JSON.stringify(gameStats));
                }
            } catch (err) {
                console.error("Erro:", err);
            }
        }

        window.addEventListener('DOMContentLoaded', carregarPontuacaoGlobal);
    </script>

    <script src="script_jogos.js"></script>

    <!-- Notifica√ß√£o -->
    <div class="notification" id="notification">
        Vamos jogar e aprender! üéÆ
    </div>

    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <a href="home.html" class="logo">LeituraKids</a>
            <nav>
                <div class="dropdown">
                    <button onclick="toggleMenu()" class="btn btn-gray">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                    <div id="menuDropdown" class="dropdown-content">
                        <a href="index.html">Sair</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Menu Vertical -->
    <nav class="side-nav">
        <div class="side-nav-item" onclick="window.location.href='home.html'" title="Perfil">
            <img src="img/casa.png" alt="Perfil">
        </div>
        <div class="side-nav-item" onclick="window.location.href='aulas.html'" title="Aulas">
            <img src="img/livro.png" alt="Aulas">
        </div>
        <div class="side-nav-item" onclick="window.location.href='atividades.html'" title="Atividades">
            <img src="img/lapis.png" alt="Atividades">
        </div>
        <div class="side-nav-item" onclick="window.location.href='mapa.html'" title="Mapa">
            <img src="img/mapa.png" alt="Mapa">
        </div>
        <div class="side-nav-item active" onclick="window.location.href='jogos.html'" title="Jogos">
            <img src="img/controle.png" alt="Jogos">
        </div>
    </nav>

    <!-- Conte√∫do Principal -->
    <main class="main-content">
        <div class="games-container">
            <!-- Cabe√ßalho -->
            <div class="games-header">
                <h1 class="games-title">Central de Jogos</h1>
                <p class="games-subtitle">Divirta-se aprendendo com jogos educativos!</p>
            </div>

            <!-- Pontua√ß√£o Global -->
            <div class="global-score">
                <div class="score-item">
                    <img src="img/trofeu.png" alt="Trof√©u" class="icon">
                    <span id="total-score">0</span> pontos
                </div>
                <div class="score-item">
                    <img src="img/estrela.png" alt="Estrela" class="icon">
                    <span id="total-correct">0</span> acertos
                </div>
                <div class="score-item">
                    <img src="img/controle.png" alt="Controle" class="icon">
                    <span id="games-played">0</span> jogos
                </div>
                <div class="score-item">
                    <img src="img/fogo.png" alt="Fogo" class="icon">
                    Sequ√™ncia: <span id="streak">0</span>
                </div>
            </div>

            <!-- Menu de Jogos -->
            <div class="games-menu" id="games-menu">
                <div class="game-card" onclick="showGame('word-search')">
                    <div class="icon"><img src="img/lupa.png" alt="Ca√ßa Palavras"></div>
                    <h3 class="game-title">Ca√ßa Palavras</h3>
                    <p class="game-description">Encontre as palavras escondidas na grade! Clique e arraste para
                        encontrar cada palavra.</p>
                </div>

                <div class="game-card" onclick="showGame('memory-game')">
                    <div class="icon"><img src="img/cerebro.png" alt="Jogo da Mem√≥ria"></div>
                    <h3 class="game-title">Jogo da Mem√≥ria</h3>
                    <p class="game-description">Encontre os pares iguais! Vire duas cartas por vez e tente combinar
                        todas.</p>
                </div>

                <div class="game-card" onclick="showGame('word-match')">
                    <div class="icon"><img src="img/link.png" alt="Associar Palavra e Emoji"></div>
                    <h3 class="game-title">Associar Palavra e Emoji</h3>
                    <p class="game-description">Combine as palavras com seus emojis correspondentes. Teste sua
                        associa√ß√£o!</p>
                </div>

                <div class="game-card" onclick="showGame('animal-quiz')">
                    <div class="icon"><img src="img/pegada.png" alt="Adivinhe o Animal"></div>
                    <h3 class="game-title">Adivinhe o Animal</h3>
                    <p class="game-description">Veja a imagem e escolha o nome correto do animal. Teste seus
                        conhecimentos!</p>
                </div>

                <div class="game-card" onclick="showGame('syllable-game')">
                    <div class="icon"><img src="img/abc.png" alt="Monte as S√≠labas"></div>
                    <h3 class="game-title">Monte as S√≠labas</h3>
                    <p class="game-description">Forme palavras juntando as s√≠labas na ordem correta. Divers√£o garantida!
                    </p>
                </div>

                <div class="game-card" onclick="showGame('drag-drop-game')">
                    <div class="icon"><img src="img/quebracabeca.png" alt="Arrastar e Soltar"></div>
                    <h3 class="game-title">Arrastar e Soltar Letras</h3>
                    <p class="game-description">Arraste as letras para os lugares certos e forme a palavra da imagem!</p>
                </div>
            </div>

            <!-- Jogo 1: Ca√ßa Palavras -->
            <div class="game-container" id="word-search">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/lupa.png" alt="Ca√ßa Palavras"></div> Ca√ßa Palavras
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="words-to-find" id="words-to-find"></div>
                <div class="word-search-grid" id="word-search-grid"></div>

                <div class="action-buttons">
                    <button class="action-button" onclick="generateNewWordSearch()">Nova Grade</button>
                </div>

                <div class="feedback" id="search-feedback"></div>
            </div>

            <!-- Jogo 2: Jogo da Mem√≥ria -->
            <div class="game-container" id="memory-game">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/cerebro.png" alt="Jogo da Mem√≥ria"></div> Jogo da Mem√≥ria
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="memory-grid" id="memory-grid"></div>

                <div class="action-buttons">
                    <button class="action-button" onclick="resetMemoryGame()">Novo Jogo</button>
                    <button class="action-button" onclick="showAllCards()">Mostrar Tudo (5s)</button>
                </div>

                <div class="feedback" id="memory-feedback"></div>
            </div>

            <!-- Jogo 3: Associar Palavra e Emoji -->
            <div class="game-container" id="word-match">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/link.png" alt="Associar Palavra e Emoji"></div> Associar
                        Palavra e Emoji
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="matching-container">
                    <div class="matching-column">
                        <h3 style="text-align: center; color: #2c3e50; margin-bottom: 1rem;">Palavras</h3>
                        <div id="words-column"></div>
                    </div>
                    <div class="matching-column">
                        <h3 style="text-align: center; color: #2c3e50; margin-bottom: 1rem;">Emojis</h3>
                        <div id="emojis-column"></div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="action-button" onclick="resetMatchingGame()">Novo Jogo</button>
                </div>

                <div class="feedback" id="matching-feedback"></div>
            </div>

            <!-- Jogo 4: Adivinhe o Animal -->
            <div class="game-container" id="animal-quiz">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/pegada.png" alt="Adivinhe o Animal"></div> Adivinhe o Animal
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="game-question">Qual √© o nome deste animal?</div>
                <img class="animal-image" id="animal-image" src="" alt="Animal">
                <div class="options-container" id="options-container"></div>
                <div class="game-message" id="game1-message"></div>
                <button class="reset-btn" onclick="resetAnimalQuestion()" style="display: none;" id="reset-btn-animal">
                    <div class="icon0"><img src="img/replay.png" alt="Tentar Novamente"></div> Tentar Novamente
                </button>

                <div class="action-buttons">
                    <button class="action-button" onclick="nextAnimalQuestion()">Pr√≥xima Pergunta</button>
                </div>
            </div>

            <!-- Jogo 5: Monte as S√≠labas -->
            <div class="game-container" id="syllable-game">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/abc.png" alt="Monte as S√≠labas"></div> Monte as S√≠labas
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="game-question">Monte a palavra com as s√≠labas!</div>
                <img class="animal-image" id="syllable-image" src="" alt="Animal">
                <div class="syllables-container" id="syllables-container"></div>
                <div class="constructed-word" id="constructed-word">
                    Clique nas s√≠labas para formar a palavra
                </div>
                <div class="game-message" id="game2-message"></div>
                <button class="reset-btn" onclick="resetSyllableQuestion()" style="display: none;"
                    id="reset-btn-syllable">
                    <div class="icon0"><img src="img/replay.png" alt="Tentar Novamente"></div> Tentar Novamente
                </button>

                <div class="action-buttons">
                    <button class="action-button" onclick="nextSyllableQuestion()">Pr√≥xima Pergunta</button>
                </div>
            </div>

            <!-- Jogo 6: Arrastar e Soltar Letras -->
            <div class="game-container" id="drag-drop-game">
                <div class="game-header">
                    <h2 class="game-title-header">
                        <div class="icon0"><img src="img/quebracabeca.png" alt="Arrastar e Soltar"></div> Arrastar e Soltar Letras
                    </h2>
                    <button class="back-button" onclick="showMenu()">Voltar</button>
                </div>

                <div class="drag-drop-container">
                    <div class="game-question">Arraste as letras para formar a palavra!</div>
                    <img class="drag-image" id="drag-image" src="" alt="Imagem">
                    
                    <div class="drop-zones" id="drop-zones"></div>
                    
                    <div class="letter-bank" id="letter-bank"></div>
                </div>

                <div class="action-buttons">
                    <button class="action-button" onclick="nextDragDropQuestion()">Pr√≥xima Palavra</button>
                </div>

                <div class="feedback" id="drag-feedback"></div>
            </div>
        </div>
    </main>
    <a href="#" class="ancora">
        <span class="material-symbols-outlined">anchor</span>
    </a>
</body>

</html>